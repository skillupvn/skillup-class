<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="H·ªá th·ªëng qu·∫£n l√Ω trung t√¢m d·∫°y h·ªçc - Qu·∫£n l√Ω h·ªçc vi√™n, l·ªãch h·∫πn, phi·∫øu ƒëƒÉng k√Ω, bi√™n lai">
    <meta name="author" content="Admin Fz">
    
    <title>Qu·∫£n L√Ω Trung T√¢m - V4.0</title>
    
    <!-- Favicon (th√™m sau n·∫øu c√≥) -->
    <!-- <link rel="icon" type="image/png" href="assets/favicon.png"> -->
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Th∆∞ vi·ªán b√™n ngo√†i -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <!-- ==========================================
         üîÑ LOADING OVERLAY (Hi·ªán khi load trang)
    ========================================== -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- ==========================================
         üè† MAIN CONTAINER
    ========================================== -->
    <div class="container">
        <!-- ==========================================
             üè† HEADER
        ========================================== -->
        <div class="header">
            <div class="header-title">
                <h1>üìö H·ªá Th·ªëng Qu·∫£n L√Ω Trung T√¢m</h1>
                <p>Version 4.0 - Qu·∫£n l√Ω to√†n di·ªán</p>
            </div>
            <div class="header-actions">
                <!-- Sync Status (Phase 4) -->
                <div class="sync-status synced" id="syncStatus" style="display: none;">
                    <span class="sync-status-dot"></span>
                    <span id="syncStatusText">ƒê√£ ƒë·ªìng b·ªô</span>
                </div>
                
                <button class="btn btn-warning btn-sm" onclick="createManualBackup()">
                    üíæ Backup
                </button>
                
                <!-- User Info (Phase 2 - Login) -->
                <!-- <div class="header-user" id="headerUser" onclick="toggleUserMenu()">
                    <div class="header-user-avatar" id="userAvatar">A</div>
                    <span class="header-user-name" id="userName">Admin</span>
                </div> -->
            </div>
        </div>

        <!-- ==========================================
             üìë TABS NAVIGATION
        ========================================== -->
        <div class="tabs" id="mainTabs">
            <button class="tab active" data-tab="dashboard" onclick="switchTab('dashboard')">
                üìä T·ªïng Quan
            </button>
            <button class="tab" data-tab="students" onclick="switchTab('students')">
                üë©‚Äçüéì H·ªçc Vi√™n
            </button>
            <button class="tab" data-tab="trial" onclick="switchTab('trial')">
                üéì H·ªçc Th·ª≠
            </button>
            <button class="tab" data-tab="appointments" onclick="switchTab('appointments')">
                üìÖ L·ªãch H·∫πn
            </button>
            <button class="tab" data-tab="registrations" onclick="switchTab('registrations')">
                üìã Phi·∫øu ƒêK
            </button>
            <button class="tab" data-tab="receipts" onclick="switchTab('receipts')">
                üßæ Bi√™n Lai
            </button>
            <!-- Tabs m·ªõi s·∫Ω th√™m ·ªü Phase 3 -->
            <!-- <button class="tab" data-tab="classes" onclick="switchTab('classes')">
                üè´ L·ªõp H·ªçc
            </button>
            <button class="tab" data-tab="teachers" onclick="switchTab('teachers')">
                üë®‚Äçüè´ Gi√°o Vi√™n
            </button>
            <button class="tab" data-tab="attendance" onclick="switchTab('attendance')">
                ‚úÖ ƒêi·ªÉm Danh
            </button>
            <button class="tab" data-tab="debts" onclick="switchTab('debts')">
                üí∞ C√¥ng N·ª£
            </button> -->
            <button class="tab" data-tab="categories" onclick="switchTab('categories')">
                üìö Danh M·ª•c
            </button>
            <!-- <button class="tab" data-tab="reports" onclick="switchTab('reports')">
                üìà B√°o C√°o
            </button> -->
            <button class="tab" data-tab="export" onclick="switchTab('export')">
                üì§ Xu·∫•t Data
            </button>
            <button class="tab" data-tab="settings" onclick="switchTab('settings')">
                ‚öôÔ∏è C√†i ƒê·∫∑t
            </button>
        </div>

        <!-- ==========================================
             üì¶ CONTENT AREA
        ========================================== -->
        <div class="content">
            
            <!-- ==========================================
                 TAB 1: üìä T·ªîNG QUAN
            ========================================== -->
            <div id="dashboard" class="tab-content active">
                <div class="page-header">
                    <h2>üìä T·ªïng Quan H·ªá Th·ªëng</h2>
                </div>
                
                <div class="stats" id="dashboardStats">
                    <!-- Stats s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
                </div>

                <div class="chart-container">
                    <h3>üìà Doanh Thu 6 Th√°ng G·∫ßn Nh·∫•t</h3>
                    <div class="chart-bars" id="revenueChart">
                        <!-- Chart s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
                    </div>
                </div>

                <div class="mt-20">
                    <h3 style="color: var(--gray-800); margin-bottom: 15px;">üìÖ L·ªãch H·∫πn S·∫Øp T·ªõi</h3>
                    <div id="upcomingAppointments">
                        <!-- Appointments s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
                    </div>
                </div>
            </div>

            <!-- ==========================================
                 TAB 2: üë©‚Äçüéì H·ªåC VI√äN
            ========================================== -->
            <div id="students" class="tab-content">
                <div class="page-header">
                    <h2>üë©‚Äçüéì Qu·∫£n L√Ω H·ªçc Vi√™n</h2>
                    <div class="page-actions">
                        <button class="btn btn-info" onclick="exportStudentsToExcel()">
                            üì§ Export Excel
                        </button>
                        <button class="btn btn-success" onclick="toggleStudentForm()">
                            ‚ûï Th√™m H·ªçc Vi√™n
                        </button>
                    </div>
                </div>

                <!-- Form Th√™m/S·ª≠a H·ªçc Vi√™n -->
                <div class="form-section" id="studentFormSection">
                    <div class="form-section-header">
                        <h3 id="studentFormTitle">‚ûï Th√™m H·ªçc Vi√™n M·ªõi</h3>
                        <button class="btn btn-sm btn-secondary" onclick="toggleStudentForm()">
                            ‚úï ƒê√≥ng
                        </button>
                    </div>
                    
                    <form id="studentForm" onsubmit="saveStudent(event)">
                        <input type="hidden" id="editStudentId" value="">
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>T√™n H·ªçc Vi√™n <span class="required">*</span></label>
                                <input type="text" id="studentName" required 
                                       placeholder="Nh·∫≠p t√™n h·ªçc vi√™n" maxlength="50">
                            </div>
                            <div class="form-group">
                                <label>Tu·ªïi <span class="required">*</span></label>
                                <input type="number" id="studentAge" required 
                                       min="3" max="100" placeholder="Nh·∫≠p tu·ªïi">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>T√™n Ph·ª• Huynh <span class="required">*</span></label>
                                <input type="text" id="parentName" required 
                                       placeholder="Nh·∫≠p t√™n ph·ª• huynh" maxlength="50">
                            </div>
                            <div class="form-group">
                                <label>S·ªë ƒêi·ªán Tho·∫°i <span class="required">*</span></label>
                                <input type="tel" id="parentPhone" required 
                                       placeholder="VD: 0901234567" maxlength="15">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Email Ph·ª• Huynh</label>
                                <input type="email" id="parentEmail" 
                                       placeholder="Nh·∫≠p email (t√πy ch·ªçn)">
                            </div>
                            <div class="form-group">
                                <label>Tr·∫°ng Th√°i <span class="required">*</span></label>
                                <select id="studentStatus" required>
                                    <option value="H·ªçc Th·ª≠">üÜï H·ªçc Th·ª≠</option>
                                    <option value="Ch·ªù ƒêƒÉng K√Ω">‚è≥ Ch·ªù ƒêƒÉng K√Ω</option>
                                    <option value="ƒê√£ ƒêƒÉng K√Ω">‚úÖ ƒê√£ ƒêƒÉng K√Ω</option>
                                    <option value="Ho√†n Th√†nh">üéì Ho√†n Th√†nh</option>
                                    <option value="Cancel">‚ùå Cancel</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>M√¥n H·ªçc Quan T√¢m <span class="required">*</span></label>
                            <div class="checkbox-group" id="subjectCheckboxes">
                                <!-- Checkboxes s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Ghi Ch√∫</label>
                            <textarea id="studentNotes" rows="2" 
                                      placeholder="Nh·∫≠p ghi ch√∫ (t√πy ch·ªçn)"></textarea>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary" id="saveStudentBtn">
                                üíæ L∆∞u H·ªçc Vi√™n
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="toggleStudentForm()">
                                ‚ùå H·ªßy
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Filter Bar -->
                <div class="filter-bar">
                    <button class="filter-btn active" data-filter="all" onclick="filterStudents('all')">
                        üìã T·∫•t c·∫£ <span class="count" id="countAll">0</span>
                    </button>
                    <button class="filter-btn" data-filter="H·ªçc Th·ª≠" onclick="filterStudents('H·ªçc Th·ª≠')">
                        üÜï H·ªçc Th·ª≠ <span class="count" id="countHocThu">0</span>
                    </button>
                    <button class="filter-btn" data-filter="Ch·ªù ƒêƒÉng K√Ω" onclick="filterStudents('Ch·ªù ƒêƒÉng K√Ω')">
                        ‚è≥ Ch·ªù ƒêK <span class="count" id="countChoDangKy">0</span>
                    </button>
                    <button class="filter-btn" data-filter="ƒê√£ ƒêƒÉng K√Ω" onclick="filterStudents('ƒê√£ ƒêƒÉng K√Ω')">
                        ‚úÖ ƒê√£ ƒêK <span class="count" id="countDaDangKy">0</span>
                    </button>
                    <button class="filter-btn" data-filter="Ho√†n Th√†nh" onclick="filterStudents('Ho√†n Th√†nh')">
                        üéì Ho√†n Th√†nh <span class="count" id="countHoanThanh">0</span>
                    </button>
                    <button class="filter-btn" data-filter="Cancel" onclick="filterStudents('Cancel')">
                        ‚ùå Cancel <span class="count" id="countCancel">0</span>
                    </button>
                    <div class="search-box">
                        <input type="text" id="searchStudent" 
                               placeholder="T√¨m ki·∫øm h·ªçc vi√™n..." 
                               oninput="searchStudents()">
                    </div>
                </div>

                <!-- Table -->
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>T√™n HV</th>
                                <th>Tu·ªïi</th>
                                <th>Ph·ª• Huynh</th>
                                <th>SƒêT</th>
                                <th>M√¥n H·ªçc</th>
                                <th>Tr·∫°ng Th√°i</th>
                                <th>Thao T√°c</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                            <!-- Data s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div class="pagination-container" id="studentsPagination">
                    <!-- Pagination s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
                </div>
            </div>

            <!-- ==========================================
                 TAB 3: üéì H·ªåC TH·ª¨
            ========================================== -->
            <div id="trial" class="tab-content">
                <div class="page-header">
                    <h2>üéì Danh S√°ch H·ªçc Th·ª≠ & Ch·ªù ƒêƒÉng K√Ω</h2>
                    <div class="page-actions">
                        <button class="btn btn-info" onclick="exportTrialStudentsToExcel()">
                            üì§ Export Excel
                        </button>
                    </div>
                </div>

                <div class="filter-bar">
                    <button class="filter-btn active" data-filter="all" onclick="filterTrialStudents('all')">
                        üìã T·∫•t c·∫£ <span class="count" id="trialCountAll">0</span>
                    </button>
                    <button class="filter-btn" data-filter="H·ªçc Th·ª≠" onclick="filterTrialStudents('H·ªçc Th·ª≠')">
                        üÜï H·ªçc Th·ª≠ <span class="count" id="trialCountHocThu">0</span>
                    </button>
                    <button class="filter-btn" data-filter="Ch·ªù ƒêƒÉng K√Ω" onclick="filterTrialStudents('Ch·ªù ƒêƒÉng K√Ω')">
                        ‚è≥ Ch·ªù ƒêƒÉng K√Ω <span class="count" id="trialCountChoDangKy">0</span>
                    </button>
                    <div class="search-box">
                        <input type="text" id="searchTrialStudent" 
                               placeholder="T√¨m ki·∫øm..." 
                               oninput="searchTrialStudents()">
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>T√™n HV</th>
                                <th>Tu·ªïi</th>
                                <th>Ph·ª• Huynh</th>
                                <th>SƒêT</th>
                                <th>M√¥n H·ªçc</th>
                                <th>Tr·∫°ng Th√°i</th>
                                <th>L·ªãch H·∫πn</th>
                                <th>Thao T√°c</th>
                            </tr>
                        </thead>
                        <tbody id="trialStudentsTableBody">
                            <!-- Data s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
                        </tbody>
                    </table>
                </div>

                <div class="pagination-container" id="trialPagination"></div>
            </div>

            <!-- ==========================================
                 TAB 4: üìÖ L·ªäCH H·∫∏N
            ========================================== -->
            <div id="appointments" class="tab-content">
                <div class="page-header">
                    <h2>üìÖ Qu·∫£n L√Ω L·ªãch H·∫πn</h2>
                    <div class="page-actions">
                        <button class="btn btn-info" onclick="exportAppointmentsToExcel()">
                            üì§ Export Excel
                        </button>
                        <button class="btn btn-success" onclick="openNewAppointmentModal()">
                            ‚ûï Th√™m L·ªãch H·∫πn
                        </button>
                    </div>
                </div>

                <div class="filter-bar">
                    <button class="filter-btn active" onclick="filterAppointments('all')">
                        üìã T·∫•t c·∫£
                    </button>
                    <button class="filter-btn" onclick="filterAppointments('upcoming')">
                        ‚è∞ S·∫Øp t·ªõi
                    </button>
                    <button class="filter-btn" onclick="filterAppointments('past')">
                        ‚úÖ ƒê√£ qua
                    </button>
                    <div class="search-box">
                        <input type="text" id="searchAppointment" 
                               placeholder="T√¨m ki·∫øm l·ªãch h·∫πn..." 
                               oninput="searchAppointments()">
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>H·ªçc Vi√™n</th>
                                <th>Ph·ª• Huynh</th>
                                <th>SƒêT</th>
                                <th>M√¥n H·ªçc</th>
                                <th>Ng√†y</th>
                                <th>Gi·ªù</th>
                                <th>Tr·∫°ng Th√°i</th>
                                <th>Thao T√°c</th>
                            </tr>
                        </thead>
                        <tbody id="appointmentsTableBody"></tbody>
                    </table>
                </div>

                <div class="pagination-container" id="appointmentsPagination"></div>
            </div>

            <!-- ==========================================
                 TAB 5: üìã PHI·∫æU ƒêƒÇNG K√ù
            ========================================== -->
            <div id="registrations" class="tab-content">
                <div class="page-header">
                    <h2>üìã Qu·∫£n L√Ω Phi·∫øu ƒêƒÉng K√Ω</h2>
                    <div class="page-actions">
                        <button class="btn btn-info" onclick="exportRegistrationsToExcel()">
                            üì§ Export Excel
                        </button>
                        <button class="btn btn-success" onclick="openNewRegistrationModal()">
                            ‚ûï T·∫°o Phi·∫øu ƒêK
                        </button>
                    </div>
                </div>

                <div class="filter-bar">
                    <div class="search-box">
                        <input type="text" id="searchRegistration" 
                               placeholder="T√¨m ki·∫øm phi·∫øu ƒëƒÉng k√Ω..." 
                               oninput="searchRegistrations()">
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>M√£ Phi·∫øu</th>
                                <th>H·ªçc Vi√™n</th>
                                <th>M√¥n H·ªçc / G√≥i / H·ªçc Ph√≠</th>
                                <th>Gi·∫£m Gi√°</th>
                                <th>Th√†nh Ti·ªÅn</th>
                                <th>Ng√†y ƒêK</th>
                                <th>Thao T√°c</th>
                            </tr>
                        </thead>
                        <tbody id="registrationsTableBody"></tbody>
                    </table>
                </div>

                <div class="pagination-container" id="registrationsPagination"></div>
            </div>

            <!-- ==========================================
                 TAB 6: üßæ BI√äN LAI
            ========================================== -->
            <div id="receipts" class="tab-content">
                <div class="page-header">
                    <h2>üßæ Qu·∫£n L√Ω Bi√™n Lai</h2>
                    <div class="page-actions">
                        <button class="btn btn-info" onclick="exportReceiptsToExcel()">
                            üì§ Export Excel
                        </button>
                        <button class="btn btn-success" onclick="openReceiptModal()">
                            ‚ûï T·∫°o Bi√™n Lai
                        </button>
                    </div>
                </div>

                <div class="filter-bar">
                    <div class="search-box">
                        <input type="text" id="searchReceipt" 
                               placeholder="T√¨m ki·∫øm bi√™n lai..." 
                               oninput="searchReceipts()">
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>M√£ BL</th>
                                <th>Lo·∫°i</th>
                                <th>H·ªçc Vi√™n</th>
                                <th>N·ªôi Dung</th>
                                <th>S·ªë Ti·ªÅn</th>
                                <th>Ng√†y</th>
                                <th>Thao T√°c</th>
                            </tr>
                        </thead>
                        <tbody id="receiptsTableBody"></tbody>
                    </table>
                </div>

                <div class="pagination-container" id="receiptsPagination"></div>
            </div>

            <!-- ==========================================
                 TAB 7: üìö DANH M·ª§C
            ========================================== -->
            <div id="categories" class="tab-content">
                <div class="page-header">
                    <h2>üìö Qu·∫£n L√Ω Danh M·ª•c</h2>
                </div>

                <div class="category-tabs">
                    <button class="category-tab active" onclick="switchCategoryTab('subjects')">
                        üìñ M√¥n H·ªçc
                    </button>
                    <button class="category-tab" onclick="switchCategoryTab('packages')">
                        üì¶ G√≥i H·ªçc Ph√≠
                    </button>
                    <button class="category-tab" onclick="switchCategoryTab('promotions')">
                        üéÅ Khuy·∫øn M√£i
                    </button>
                </div>

                <!-- Subjects Content -->
                <div id="subjectsContent" class="category-content active">
                    <div class="d-flex justify-between align-center mb-15">
                        <h3 style="color: var(--gray-800);">üìñ Danh S√°ch M√¥n H·ªçc</h3>
                        <button class="btn btn-success btn-sm" onclick="openSubjectModal()">
                            ‚ûï Th√™m
                        </button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Icon</th>
                                    <th>T√™n M√¥n</th>
                                    <th>H·ªçc Ph√≠ M·∫∑c ƒê·ªãnh</th>
                                    <th>Thao T√°c</th>
                                </tr>
                            </thead>
                            <tbody id="subjectsTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Packages Content -->
                <div id="packagesContent" class="category-content">
                    <div class="d-flex justify-between align-center mb-15">
                        <h3 style="color: var(--gray-800);">üì¶ Danh S√°ch G√≥i H·ªçc Ph√≠</h3>
                        <button class="btn btn-success btn-sm" onclick="openPackageModal()">
                            ‚ûï Th√™m
                        </button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>T√™n G√≥i</th>
                                    <th>M√¥n H·ªçc</th>
                                    <th>S·ªë Bu·ªïi</th>
                                    <th>H·ªçc Ph√≠</th>
                                    <th>Thao T√°c</th>
                                </tr>
                            </thead>
                            <tbody id="packagesTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Promotions Content -->
                <div id="promotionsContent" class="category-content">
                    <div class="d-flex justify-between align-center mb-15">
                        <h3 style="color: var(--gray-800);">üéÅ Danh S√°ch Khuy·∫øn M√£i</h3>
                        <button class="btn btn-success btn-sm" onclick="openPromotionModal()">
                            ‚ûï Th√™m
                        </button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>T√™n KM</th>
                                    <th>Lo·∫°i</th>
                                    <th>Gi√° Tr·ªã</th>
                                    <th>Th·ªùi H·∫°n</th>
                                    <th>Tr·∫°ng Th√°i</th>
                                    <th>Thao T√°c</th>
                                </tr>
                            </thead>
                            <tbody id="promotionsTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ==========================================
                 TAB 8: üì§ XU·∫§T DATA
            ========================================== -->
            <div id="export" class="tab-content">
                <div class="page-header">
                    <h2>üì§ Xu·∫•t D·ªØ Li·ªáu & Sao L∆∞u</h2>
                </div>

                <div class="settings-group">
                    <h3>üìä Xu·∫•t File Excel</h3>
                    <div class="d-flex gap-10 flex-wrap">
                        <button class="btn btn-success" onclick="exportAllToExcel()">
                            üìä Xu·∫•t T·∫•t C·∫£
                        </button>
                        <button class="btn btn-info" onclick="exportStudentsToExcel()">
                            üë©‚Äçüéì H·ªçc Vi√™n
                        </button>
                        <button class="btn btn-warning" onclick="exportAppointmentsToExcel()">
                            üìÖ L·ªãch H·∫πn
                        </button>
                        <button class="btn btn-primary" onclick="exportRegistrationsToExcel()">
                            üìã Phi·∫øu ƒêK
                        </button>
                        <button class="btn btn-secondary" onclick="exportReceiptsToExcel()">
                            üßæ Bi√™n Lai
                        </button>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>üíæ Sao L∆∞u & Kh√¥i Ph·ª•c</h3>
                    <div class="d-flex gap-10 flex-wrap">
                        <button class="btn btn-success" onclick="exportBackupJSON()">
                            üíæ T·∫£i Backup JSON
                        </button>
                        <label class="btn btn-info" style="cursor: pointer;">
                            üìÅ Kh√¥i Ph·ª•c JSON
                            <input type="file" accept=".json" onchange="restoreFromJSON(event)" style="display: none;">
                        </label>
                        <label class="btn btn-warning" style="cursor: pointer;">
                            üì• Import Excel
                            <input type="file" accept=".xlsx,.xls" onchange="importFromExcel(event)" style="display: none;">
                        </label>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>üìú L·ªãch S·ª≠ Backup T·ª± ƒê·ªông</h3>
                    <div id="backupHistoryList">
                        <!-- Backup history s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
                    </div>
                </div>
            </div>

            <!-- ==========================================
                 TAB 9: ‚öôÔ∏è C√ÄI ƒê·∫∂T
            ========================================== -->
            <div id="settings" class="tab-content">
                <div class="page-header">
                    <h2>‚öôÔ∏è C√†i ƒê·∫∑t H·ªá Th·ªëng</h2>
                </div>

                <div class="settings-group">
                    <h3>üè¢ Th√¥ng Tin Trung T√¢m</h3>
                    <form id="centerInfoForm" onsubmit="saveCenterInfo(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>T√™n Trung T√¢m <span class="required">*</span></label>
                                <input type="text" id="centerName" placeholder="VD: Trung T√¢m ABC">
                            </div>
                            <div class="form-group">
                                <label>S·ªë ƒêi·ªán Tho·∫°i <span class="required">*</span></label>
                                <input type="tel" id="centerPhone" placeholder="VD: 0912345678">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>ƒê·ªãa Ch·ªâ <span class="required">*</span></label>
                            <input type="text" id="centerAddress" placeholder="VD: 123 ƒê∆∞·ªùng ABC">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="centerEmail" placeholder="VD: contact@abc.edu.vn">
                            </div>
                            <div class="form-group">
                                <label>Website</label>
                                <input type="url" id="centerWebsite" placeholder="VD: https://abc.edu.vn">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Logo</label>
                            <input type="file" id="centerLogo" accept="image/*" onchange="previewLogo(event)">
                            <div class="logo-preview" id="logoPreview">
                                <span class="text-muted">Logo</span>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">üíæ L∆∞u Th√¥ng Tin</button>
                    </form>
                </div>

                <div class="settings-group">
                    <h3>üí≥ Th√¥ng Tin Ng√¢n H√†ng</h3>
                    <form id="bankInfoForm" onsubmit="saveBankInfo(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>T√™n Ng√¢n H√†ng <span class="required">*</span></label>
                                <input type="text" id="bankName" placeholder="VD: Vietcombank">
                            </div>
                            <div class="form-group">
                                <label>S·ªë T√†i Kho·∫£n <span class="required">*</span></label>
                                <input type="text" id="bankAccount" placeholder="VD: 1234567890">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Ch·ªß T√†i Kho·∫£n <span class="required">*</span></label>
                                <input type="text" id="bankAccountName" placeholder="VD: NGUYEN VAN A">
                            </div>
                            <div class="form-group">
                                <label>Chi Nh√°nh</label>
                                <input type="text" id="bankBranch" placeholder="VD: Chi nh√°nh T√¢n B√¨nh">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">üíæ L∆∞u Th√¥ng Tin</button>
                    </form>
                    <div class="mt-15">
                        <h4 style="font-size: 0.95em; margin-bottom: 10px;">QR Chuy·ªÉn Kho·∫£n:</h4>
                        <div id="bankQRCode"></div>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>üîÑ Sao L∆∞u T·ª± ƒê·ªông</h3>
                    <div class="d-flex align-center gap-15">
                        <label class="d-flex align-center gap-10" style="cursor: pointer;">
                            <input type="checkbox" id="autoBackupToggle" onchange="toggleAutoBackup()">
                            <span>B·∫≠t sao l∆∞u t·ª± ƒë·ªông</span>
                        </label>
                        <span id="autoBackupStatus" class="text-muted"></span>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>üóëÔ∏è X√≥a D·ªØ Li·ªáu</h3>
                    <p class="text-muted mb-15" style="font-size: 0.9em;">
                        ‚ö†Ô∏è H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c! H√£y backup tr∆∞·ªõc khi x√≥a.
                    </p>
                    <button class="btn btn-danger" onclick="clearAllData()">
                        üóëÔ∏è X√≥a To√†n B·ªô D·ªØ Li·ªáu
                    </button>
                </div>
            </div>

        </div><!-- End .content -->
    </div><!-- End .container -->

    <!-- ==========================================
         üîî MODALS
    ========================================== -->
    
    <!-- Quick View Modal -->
    <div id="quickViewModal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>üëÅÔ∏è Th√¥ng Tin Chi Ti·∫øt</h2>
                <button class="modal-close" onclick="closeModal('quickViewModal')">&times;</button>
            </div>
            <div class="modal-body" id="quickViewContent"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('quickViewModal')">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- Appointment Modal -->
    <div id="appointmentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="appointmentModalTitle">üìÖ ƒê·∫∑t L·ªãch H·∫πn</h2>
                <button class="modal-close" onclick="closeModal('appointmentModal')">&times;</button>
            </div>
            <form id="appointmentForm" onsubmit="saveAppointment(event)">
                <input type="hidden" id="appointmentStudentId">
                <input type="hidden" id="editAppointmentId">
                
                <div class="form-group">
                    <label>H·ªçc Vi√™n <span class="required">*</span></label>
                    <div class="searchable-select" id="appointmentStudentSelect">
                        <input type="text" class="searchable-select-input" id="appointmentStudentInput" 
                               placeholder="-- Ch·ªçn ho·∫∑c t√¨m h·ªçc vi√™n --" readonly 
                               onclick="toggleStudentDropdown()">
                        <div class="searchable-select-dropdown" id="appointmentStudentDropdown">
                            <div class="searchable-select-search">
                                <input type="text" id="appointmentStudentSearch" 
                                       placeholder="T√¨m ki·∫øm..." 
                                       oninput="filterStudentDropdown()">
                            </div>
                            <div id="appointmentStudentOptions"></div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>M√¥n H·ªçc <span class="required">*</span></label>
                    <select id="appointmentSubject" required>
                        <option value="">-- Ch·ªçn m√¥n h·ªçc --</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Ng√†y H·∫πn <span class="required">*</span></label>
                        <input type="date" id="appointmentDate" required>
                    </div>
                    <div class="form-group">
                        <label>Gi·ªù H·∫πn <span class="required">*</span></label>
                        <input type="time" id="appointmentTime" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Ghi Ch√∫</label>
                    <textarea id="appointmentNotes" rows="2" placeholder="Ghi ch√∫"></textarea>
                </div>
                
                <div id="appointmentConflictWarning" class="hidden" 
                     style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ffc107; font-size: 0.9em;">
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('appointmentModal')">H·ªßy</button>
                    <button type="submit" class="btn btn-success">üíæ L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Registration Modal -->
    <div id="registrationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìã T·∫°o Phi·∫øu ƒêƒÉng K√Ω</h2>
                <button class="modal-close" onclick="closeModal('registrationModal')">&times;</button>
            </div>
            <form id="registrationForm" onsubmit="saveRegistration(event)">
                <input type="hidden" id="regStudentId">
                
                <div class="form-group">
                    <label>H·ªçc Vi√™n <span class="required">*</span></label>
                    <div class="searchable-select" id="regStudentSelect">
                        <input type="text" class="searchable-select-input" id="regStudentInput" 
                               placeholder="-- Ch·ªçn ho·∫∑c t√¨m h·ªçc vi√™n --" readonly 
                               onclick="toggleRegStudentDropdown()">
                        <div class="searchable-select-dropdown" id="regStudentDropdown">
                            <div class="searchable-select-search">
                                <input type="text" id="regStudentSearch" 
                                       placeholder="T√¨m ki·∫øm..." 
                                       oninput="filterRegStudentDropdown()">
                            </div>
                            <div id="regStudentOptions"></div>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>M√¥n H·ªçc <span class="required">*</span></label>
                        <select id="regSubject" required onchange="loadPackagesForSubject()">
                            <option value="">-- Ch·ªçn m√¥n --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>G√≥i H·ªçc Ph√≠</label>
                        <select id="regPackage" onchange="applyPackageFee()">
                            <option value="">-- Nh·∫≠p th·ªß c√¥ng --</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>H·ªçc Ph√≠ (VNƒê) <span class="required">*</span></label>
                    <input type="text" id="regTuitionFee" required 
                           placeholder="VD: 2,000,000" 
                           oninput="formatCurrencyInput(this); calculateFinalAmount()">
                </div>
                
                <div class="form-group">
                    <label>Khuy·∫øn M√£i</label>
                    <div id="regPromotionList" class="checkbox-group"></div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Gi·∫£m Gi√°</label>
                        <input type="text" id="regDiscountAmount" readonly 
                               style="background: #ffebee; color: #c62828; font-weight: 600;">
                    </div>
                    <div class="form-group">
                        <label>Th√†nh Ti·ªÅn</label>
                        <input type="text" id="regFinalAmount" readonly 
                               style="background: #e8f5e9; color: #388e3c; font-weight: 600;">
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('registrationModal')">H·ªßy</button>
                    <button type="submit" class="btn btn-success">‚úÖ T·∫°o Phi·∫øu ƒêK</button>
                </div>
            </form>
        </div>
    </div>

    <!-- View Registration Modal -->
    <div id="viewRegistrationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìã Chi Ti·∫øt Phi·∫øu ƒêƒÉng K√Ω</h2>
                <button class="modal-close" onclick="closeModal('viewRegistrationModal')">&times;</button>
            </div>
            <div class="modal-body print-area" id="registrationPreviewContent"></div>
            <div class="modal-footer">
                <button class="btn btn-info" onclick="printRegistration()">üñ®Ô∏è In</button>
                <button class="btn btn-primary" onclick="downloadRegistrationPDF()">üìÑ T·∫£i PDF</button>
                <button class="btn btn-secondary" onclick="closeModal('viewRegistrationModal')">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div id="receiptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üßæ T·∫°o Bi√™n Lai</h2>
                <button class="modal-close" onclick="closeModal('receiptModal')">&times;</button>
            </div>
            <form id="receiptForm" onsubmit="saveReceipt(event)">
                <input type="hidden" id="editReceiptId">
                
                <div class="form-group">
                    <label>Lo·∫°i <span class="required">*</span></label>
                    <select id="receiptType" required>
                        <option value="">-- Ch·ªçn lo·∫°i --</option>
                        <option value="Bi√™n Lai ƒêi·ªán T·ª≠">üí≥ Bi√™n Lai ƒêi·ªán T·ª≠</option>
                        <option value="Phi·∫øu Thu">üíµ Phi·∫øu Thu</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>H·ªçc Vi√™n <span class="required">*</span> (ch·ªâ HV "ƒê√£ ƒêƒÉng K√Ω")</label>
                    <select id="receiptStudentId" required onchange="fillReceiptStudentInfo()">
                        <option value="">-- Ch·ªçn h·ªçc vi√™n --</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Ph·ª• Huynh</label>
                        <input type="text" id="receiptParentName" readonly style="background: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label>SƒêT</label>
                        <input type="text" id="receiptParentPhone" readonly style="background: #f8f9fa;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Li√™n k·∫øt Phi·∫øu ƒêƒÉng K√Ω</label>
                    <select id="receiptRegistrationSelect" onchange="fillFromRegistration()">
                        <option value="">-- Ch·ªçn phi·∫øu ƒêK ƒë·ªÉ l·∫•y s·ªë ti·ªÅn --</option>
                    </select>
                    <input type="hidden" id="receiptRegistrationId">
                    <p class="help-text">Ch·ªçn phi·∫øu ƒêK ƒë·ªÉ t·ª± ƒë·ªông ƒëi·ªÅn n·ªôi dung v√† s·ªë ti·ªÅn</p>
                </div>

                <div class="form-group">
                    <label>N·ªôi Dung <span class="required">*</span></label>
                    <input type="text" id="receiptDescription" required 
                           placeholder="VD: H·ªçc ph√≠ th√°ng 1">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>S·ªë Ti·ªÅn (VNƒê) <span class="required">*</span></label>
                        <input type="text" id="receiptAmount" required 
                               placeholder="VD: 2,000,000" 
                               oninput="formatCurrencyInput(this)">
                    </div>
                    <div class="form-group">
                        <label>Ng√†y <span class="required">*</span></label>
                        <input type="date" id="receiptDate" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Ghi Ch√∫</label>
                    <textarea id="receiptNotes" rows="2" placeholder="Ghi ch√∫"></textarea>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('receiptModal')">H·ªßy</button>
                    <button type="submit" class="btn btn-success">üíæ L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- View Receipt Modal -->
    <div id="viewReceiptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üßæ Xem Bi√™n Lai</h2>
                <button class="modal-close" onclick="closeModal('viewReceiptModal')">&times;</button>
            </div>
            <div class="modal-body print-area" id="receiptPreviewContent"></div>
            <div class="modal-footer">
                <button class="btn btn-info" onclick="printReceipt()">üñ®Ô∏è In</button>
                <button class="btn btn-primary" onclick="downloadReceiptPDF()">üìÑ T·∫£i PDF</button>
                <button class="btn btn-secondary" onclick="closeModal('viewReceiptModal')">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- Subject Modal -->
    <div id="subjectModal" class="modal">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h2 id="subjectModalTitle">üìñ Th√™m M√¥n H·ªçc</h2>
                <button class="modal-close" onclick="closeModal('subjectModal')">&times;</button>
            </div>
            <form id="subjectForm" onsubmit="saveSubject(event)">
                <input type="hidden" id="editSubjectId">
                <div class="form-row">
                    <div class="form-group">
                        <label>Icon <span class="required">*</span></label>
                        <input type="text" id="subjectIcon" required placeholder="VD: ‚ôüÔ∏è">
                    </div>
                    <div class="form-group">
                        <label>T√™n M√¥n <span class="required">*</span></label>
                        <input type="text" id="subjectName" required placeholder="VD: C·ªù Vua">
                    </div>
                </div>
                <div class="form-group">
                    <label>H·ªçc Ph√≠ M·∫∑c ƒê·ªãnh <span class="required">*</span></label>
                    <input type="text" id="subjectDefaultFee" required 
                           placeholder="VD: 2,000,000" 
                           oninput="formatCurrencyInput(this)">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('subjectModal')">H·ªßy</button>
                    <button type="submit" class="btn btn-success">üíæ L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Package Modal -->
    <div id="packageModal" class="modal">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h2 id="packageModalTitle">üì¶ Th√™m G√≥i H·ªçc Ph√≠</h2>
                <button class="modal-close" onclick="closeModal('packageModal')">&times;</button>
            </div>
            <form id="packageForm" onsubmit="savePackage(event)">
                <input type="hidden" id="editPackageId">
                <div class="form-group">
                    <label>T√™n G√≥i <span class="required">*</span></label>
                    <input type="text" id="packageName" required placeholder="VD: G√≥i C∆° B·∫£n">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>M√¥n H·ªçc <span class="required">*</span></label>
                        <select id="packageSubject" required></select>
                    </div>
                    <div class="form-group">
                        <label>S·ªë Bu·ªïi <span class="required">*</span></label>
                        <input type="number" id="packageSessions" required min="1" placeholder="VD: 8">
                    </div>
                </div>
                <div class="form-group">
                    <label>H·ªçc Ph√≠ <span class="required">*</span></label>
                    <input type="text" id="packageFee" required 
                           placeholder="VD: 1,600,000" 
                           oninput="formatCurrencyInput(this)">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('packageModal')">H·ªßy</button>
                    <button type="submit" class="btn btn-success">üíæ L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Promotion Modal -->
    <div id="promotionModal" class="modal">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h2 id="promotionModalTitle">üéÅ Th√™m Khuy·∫øn M√£i</h2>
                <button class="modal-close" onclick="closeModal('promotionModal')">&times;</button>
            </div>
            <form id="promotionForm" onsubmit="savePromotion(event)">
                <input type="hidden" id="editPromotionId">
                <div class="form-group">
                    <label>T√™n KM <span class="required">*</span></label>
                    <input type="text" id="promotionName" required placeholder="VD: KM Khai Tr∆∞∆°ng">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Lo·∫°i <span class="required">*</span></label>
                        <select id="promotionType" required>
                            <option value="percent">Gi·∫£m %</option>
                            <option value="fixed">Gi·∫£m VNƒê</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Gi√° Tr·ªã <span class="required">*</span></label>
                        <input type="number" id="promotionValue" required min="0" placeholder="VD: 10">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>T·ª´ Ng√†y <span class="required">*</span></label>
                        <input type="date" id="promotionStartDate" required>
                    </div>
                    <div class="form-group">
                        <label>ƒê·∫øn Ng√†y <span class="required">*</span></label>
                        <input type="date" id="promotionEndDate" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('promotionModal')">H·ªßy</button>
                    <button type="submit" class="btn btn-success">üíæ L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <span id="notificationIcon"></span>
        <span id="notificationMessage"></span>
        <button class="notification-close" onclick="hideNotification()">&times;</button>
    </div>

    <!-- ==========================================
         üìú JAVASCRIPT FILES
         Th·ª© t·ª± load quan tr·ªçng!
    ========================================== -->
    <!-- Core -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data.js"></script>
    <script src="js/ui.js"></script>
    
    <!-- Features -->
    <script src="js/dashboard.js"></script>
    <script src="js/students.js"></script>
    <script src="js/trial.js"></script>
    <script src="js/appointments.js"></script>
    <script src="js/registrations.js"></script>
    <script src="js/receipts.js"></script>
    <script src="js/categories.js"></script>
    <script src="js/export.js"></script>
    <script src="js/settings.js"></script>
    
    <!-- Main App -->
    <script src="js/app.js"></script>
</body>
</html>
